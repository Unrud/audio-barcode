(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(e,t,n){"use strict";n.r(t);var r=n(2);r.m();const o=r.a.get_beep_time(),c=r.a.get_attack_time(),i=r.a.get_release_time(),u=r.a.get_payload_len(),a=r.a.get_symbol_mnemonics(),l=r.a.get_max_message_len();let s=document.querySelector("#message-btn"),f=document.querySelector("#message-form"),d=f.querySelector("#message-form input"),m=f.querySelector("#message-form button"),p=document.querySelector("#packet-btn"),g=document.querySelector("#packet-form"),h=g.querySelector("#packet-form input"),b=g.querySelector("#packet-form button"),y=document.querySelector("#log");function w(e,t){let n=document.createElement("p");for(let e of t)n.classList.add(e);n.textContent=e,y.prepend(n)}function v(e,t){let n="";for(let t=0;t<e.length;t++)n+=a.charAt(e[t]);w(n,["packet",t])}function _(e,t){w(e,["message",t])}s.addEventListener("click",(function(e){e.preventDefault(),document.documentElement.classList.add("message"),document.documentElement.classList.remove("packet")})),p.addEventListener("click",(function(e){e.preventDefault(),document.documentElement.classList.remove("message"),document.documentElement.classList.add("packet")}));let x=new(window.AudioContext||window.webkitAudioContext);let A=[],k=!1;let E=r.a.new(x.sampleRate,(function(e){v(e,"rx")}),(function(e){_((new TextDecoder).decode(new Uint8Array(e)),"rx")}),(function e(t,n){if(t&&v(t,"tx"),n&&A.push(n),k)return;if(!(n=A.shift()))return m.removeAttribute("disabled"),void b.removeAttribute("disabled");k=!0,m.setAttribute("disabled",""),b.setAttribute("disabled","");let r=x.createOscillator(),u=x.createGain();r.connect(u),u.connect(x.destination),r.type="sine";let a=x.currentTime;u.gain.setValueAtTime(0,a);for(let e=0;e<n.length;e++){let t=a+o*e;u.gain.linearRampToValueAtTime(.5,t+c),u.gain.setValueAtTime(.5,t+o-i),u.gain.linearRampToValueAtTime(0,t+o),r.frequency.setValueAtTime(n[e],t)}r.start(a),r.stop(a+o*n.length),r.onended=function(){k=!1,e()}}));function T(e){console.log("The following gUM error occured: "+e),w("Microphone access denied: Unable to receive",["err"])}function S(){let e=d.value,t=(new TextEncoder).encode(e);t.length>l?d.setCustomValidity("Message too long: "+t.length):d.setCustomValidity("")}function C(){let e=h.value;for(let t of e)if(-1==a.indexOf(t))return void h.setCustomValidity("Allowed symbols: "+a);h.setCustomValidity("")}navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,channelCount:1}}).then((function(e){let t=x.createMediaStreamSource(e),n=x.createScriptProcessor(0,1,1);t.connect(n),n.connect(x.destination),x.resume().catch(T);let r=document.createElement("p");r.textContent="Performance: ";let o=document.createTextNode("â€¦");r.append(o),y.prepend(r);let c=performance.now(),i=0;n.onaudioprocess=function(e){let t=e.inputBuffer,n=t.getChannelData(0);for(let e=0;e<t.length;e++)E.push_sample(k?0:n[e]);i+=t.length;let u=performance.now()-c;if(u>=2e3){let e=i/(t.sampleRate*u/1e3);c+=u,i=0,o.textContent=Math.round(100*e)+"%",e<.98?r.classList.add("err"):r.classList.remove("err")}}})).catch(T):T("Not supported on your browser!"),f.addEventListener("submit",(function(e){e.preventDefault();let t=d.value,n=(new TextEncoder).encode(t);E.send_message(n),_(t,"tx")})),d.setAttribute("maxlength",l),S(),d.addEventListener("input",S),g.addEventListener("submit",(function(e){e.preventDefault();let t=h.value,n=new Uint8Array(u);for(let e=0,r=0;e<t.length&&r<n.length;e++){let o=a.indexOf(t[e]);-1!==o&&(n[r]=o,r++)}E.send(n)})),h.setAttribute("maxlength",u),C(),h.addEventListener("input",C)},function(e,t,n){"use strict";(function(e){n.d(t,"m",(function(){return w})),n.d(t,"a",(function(){return x})),n.d(t,"k",(function(){return A})),n.d(t,"f",(function(){return k})),n.d(t,"j",(function(){return E})),n.d(t,"g",(function(){return T})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return q})),n.d(t,"h",(function(){return L})),n.d(t,"d",(function(){return O})),n.d(t,"i",(function(){return j})),n.d(t,"l",(function(){return D}));var r=n(4);const o=new Array(32).fill(void 0);function c(e){return o[e]}o.push(void 0,null,!0,!1);let i=o.length;function u(e){const t=c(e);return function(e){e<36||(o[e]=i,i=e)}(e),t}function a(e){i===o.length&&o.push(o.length+1);const t=i;return i=o[t],o[t]=e,t}let l=0,s=null;function f(){return null!==s&&s.buffer===r.g.buffer||(s=new Uint8Array(r.g.buffer)),s}let d=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const m="function"==typeof d.encodeInto?function(e,t){return d.encodeInto(e,t)}:function(e,t){const n=d.encode(e);return t.set(n),{read:e.length,written:n.length}};function p(e,t,n){if(void 0===n){const n=d.encode(e),r=t(n.length);return f().subarray(r,r+n.length).set(n),l=n.length,r}let r=e.length,o=t(r);const c=f();let i=0;for(;i<r;i++){const t=e.charCodeAt(i);if(t>127)break;c[o+i]=t}if(i!==r){0!==i&&(e=e.slice(i)),o=n(o,r,r=i+3*e.length);const t=f().subarray(o+i,o+r);i+=m(e,t).written}return l=i,o}let g=null;function h(){return null!==g&&g.buffer===r.g.buffer||(g=new Int32Array(r.g.buffer)),g}let b=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});function y(e,t){return b.decode(f().subarray(e,e+t))}function w(){r.f()}function v(e,t){const n=t(1*e.length);return f().set(e,n/1),l=e.length,n}function _(e){return function(){try{return e.apply(this,arguments)}catch(e){r.b(a(e))}}}b.decode();class x{static __wrap(e){const t=Object.create(x.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,r.a(e)}static new(e,t,n,o){var c=r.m(e,a(t),a(n),a(o));return x.__wrap(c)}send(e){var t=v(e,r.d),n=l;r.o(this.ptr,t,n)}send_message(e){var t=v(e,r.d),n=l;r.p(this.ptr,t,n)}push_sample(e){r.n(this.ptr,e)}static get_payload_len(){return r.k()>>>0}static get_beep_time(){return r.i()}static get_attack_time(){return r.h()}static get_release_time(){return r.h()}static get_symbol_mnemonics(){try{r.l(8);var e=h()[2],t=h()[3];return y(e,t)}finally{r.c(e,t)}}static get_max_message_len(){return r.j()>>>0}}const A=function(e){u(e)},k=function(){return a(new Array)},E=function(e){return a(e)},T=function(e,t){return c(e).push(c(t))},S=_((function(e,t,n){return a(c(e).call(c(t),c(n)))})),C=_((function(e,t,n,r){return a(c(e).call(c(t),c(n),c(r)))})),q=function(){return a(new Error)},L=function(e,t){var n=p(c(t).stack,r.d,r.e),o=l;h()[e/4+1]=o,h()[e/4+0]=n},O=function(e,t){try{console.error(y(e,t))}finally{r.c(e,t)}},j=function(e,t){var n=p(function e(t){const n=typeof t;if("number"==n||"boolean"==n||null==t)return""+t;if("string"==n)return`"${t}"`;if("symbol"==n){const e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==n){const e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){const n=t.length;let r="[";n>0&&(r+=e(t[0]));for(let o=1;o<n;o++)r+=", "+e(t[o]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(t));let o;if(!(r.length>1))return toString.call(t);if(o=r[1],"Object"==o)try{return"Object("+JSON.stringify(t)+")"}catch(e){return"Object"}return t instanceof Error?`${t.name}: ${t.message}\n${t.stack}`:o}(c(t)),r.d,r.e),o=l;h()[e/4+1]=o,h()[e/4+0]=n},D=function(e,t){throw new Error(y(e,t))}}).call(this,n(3)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(2);r.q()}]]);